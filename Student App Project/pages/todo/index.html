<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To Do - UniHUB</title>
    <link rel="stylesheet" href="../../assets/css/styles.css">
</head>
<body>
    <div class="container">
        <h1 class="page-title">To Do</h1>
        <p class="page-subtitle">Deliverables without due dates that need attention</p>
        
        <div class="data-section">
            <h2 class="section-title">Undated Deliverables</h2>
            <div id="todo-container" class="deliverables-grid">
                <div class="empty-state">
                    Loading undated deliverables...
                </div>
            </div>
        </div>
    </div>

    <script src="../../assets/js/navigation.js"></script>
    <script>
        // Embedded data - works with both Live Server and direct file opening
        const deliverablesData = [
          {
            "Course ID": "MECH 205",
            "Category": "Exam",
            "Deliverable": "Midterm Exam",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "12",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "THRM 200",
            "Category": "Exam",
            "Deliverable": "Midterm Exam",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "30",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "STCS 255",
            "Category": "Test",
            "Deliverable": "Test 2",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "7.5",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "STCS 255",
            "Category": "Exam",
            "Deliverable": "Midterm",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "30",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "STCS 255",
            "Category": "Lab",
            "Deliverable": "Lab 1 – Force Table",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "3",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "STCS 255",
            "Category": "Lab",
            "Deliverable": "Lab 2 – Two Force Crane",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "3",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "STCS 255",
            "Category": "Lab",
            "Deliverable": "Lab 3 – Beam",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "3",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "STCS 255",
            "Category": "Lab",
            "Deliverable": "Lab 4 – Three Force Crane",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "3",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "STCS 255",
            "Category": "Lab",
            "Deliverable": "Lab 6 – Truss",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "3",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "MATH 238",
            "Category": "Quiz",
            "Deliverable": "Quiz 2",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "2",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "MATH 238",
            "Category": "Quiz",
            "Deliverable": "Quiz 3",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "2",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "MATH 238",
            "Category": "Quiz",
            "Deliverable": "Quiz 4",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "2",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "MATH 238",
            "Category": "Quiz",
            "Deliverable": "Quiz 5",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "2",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "MATH 238",
            "Category": "Quiz",
            "Deliverable": "Quiz 6",
            "Open Date": "",
            "Close Date": "",
            "Weight %": "2",
            "Grade %": "",
            "Letter Grade": ""
          },
          {
            "Course ID": "MATH 238",
            "Category": "Exam",
            "Deliverable": "Midterm Exam",
            "Open Date": "",
            "Close Date": "Oct 31, 2025 11:59 PM",
            "Weight %": "30",
            "Grade %": "",
            "Letter Grade": ""
          }
        ];

        // Load and display undated deliverables - now works with both Live Server and direct file opening
        function loadTodoItems() {
            try {
                displayTodoItems(deliverablesData);
            } catch (error) {
                console.error('Error loading todo items:', error);
                document.getElementById('todo-container').innerHTML = 
                    '<div class="empty-state">Error loading todo items. Please check that the data is properly embedded.</div>';
            }
        }

        function displayTodoItems(deliverables) {
            const container = document.getElementById('todo-container');
            
            // Filter deliverables that don't have due dates
            const undatedDeliverables = deliverables.filter(deliverable => {
                const closeDate = deliverable['Close Date'];
                return !closeDate || closeDate === '' || closeDate === 'Not specified';
            });
            
            if (undatedDeliverables.length === 0) {
                container.innerHTML = '<div class="empty-state">All deliverables have due dates! Great job staying organized.</div>';
                return;
            }

            // Sort by course ID and then by deliverable name
            const sortedDeliverables = undatedDeliverables.sort((a, b) => {
                const courseA = a['Course ID'] || '';
                const courseB = b['Course ID'] || '';
                if (courseA !== courseB) {
                    return courseA.localeCompare(courseB);
                }
                const deliverableA = a['Deliverable'] || '';
                const deliverableB = b['Deliverable'] || '';
                return deliverableA.localeCompare(deliverableB);
            });

            container.innerHTML = `
                <div class="deliverables-grid">
                    ${sortedDeliverables.map(deliverable => {
                        const hasGrade = deliverable['Grade %'] && deliverable['Grade %'] !== '' && deliverable['Grade %'] !== 'Not graded';
                        const cardClass = hasGrade ? 'deliverable-card graded' : 'deliverable-card todo-card';
                        
                        return `
                        <div class="${cardClass}">
                            <div class="deliverable-header">
                                <div class="deliverable-category">${deliverable['Category'] || 'Assignment'}</div>
                                <div class="deliverable-weight">${deliverable['Weight %'] || '0'}%</div>
                            </div>
                            
                            <div class="deliverable-title">${deliverable['Deliverable'] || 'Untitled Deliverable'}</div>
                            <div class="deliverable-course">${deliverable['Course ID'] || 'Unknown Course'}</div>
                            
                            <div class="deliverable-dates">
                                <div class="date-item">
                                    <span class="date-label">Opens:</span>
                                    <span class="date-value">${deliverable['Open Date'] || 'Not specified'}</span>
                                </div>
                                <div class="date-item">
                                    <span class="date-label">Due:</span>
                                    <span class="date-value todo-highlight">No due date set</span>
                                </div>
                            </div>
                            
                            <div class="deliverable-grades">
                                <div class="grade-item">
                                    <span class="grade-label">Grade:</span>
                                    <span class="grade-value">${deliverable['Grade %'] || 'Not graded'}</span>
                                </div>
                                <div class="grade-item">
                                    <span class="grade-label">Letter:</span>
                                    <span class="grade-value">${deliverable['Letter Grade'] || 'Not graded'}</span>
                                </div>
                            </div>
                            
                            <div class="todo-note">
                                <span class="todo-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/><line x1="12" y1="9" x2="12" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="12" y1="17" x2="12.01" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></span>
                                <span class="todo-text">Needs due date</span>
                            </div>
                        </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        // Load todo items when page loads
        document.addEventListener('DOMContentLoaded', loadTodoItems);
    </script>
</body>
</html>
