<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Courses - UniHUB</title>
    <link rel="stylesheet" href="../../assets/css/styles.css">
</head>
<body>
    <div class="container">
        <h1 class="page-title">Courses</h1>
        <p class="page-subtitle">Manage your academic courses and track your progress</p>
        
        <div class="data-section">
            <h2 class="section-title">Course Information</h2>
            <div id="courses-container" class="courses-grid">
                <div class="empty-state">
                    No courses data available. Load data from Courses.json to display course information.
                </div>
            </div>
        </div>
    </div>

    <script src="../../assets/js/navigation.js"></script>
    <script>
        // Embedded data - works with both Live Server and direct file opening
        const coursesData = [
          {
            "Course ID": "COMP 213",
            "Course Name": "Computing for Engineering Technology",
            "Course Average Weighted Grade": "",
            "Credit Hours": "3",
            "Course Description": "This applied computer course provides students with critical electronic communications, data and file management skills, along with a strong focus on using common productivity applications to format, calculate, analyze, visualize, and present or report data and information. Industry standard project management principles are implemented throughout the course from a digital perspective, so students can have an appreciation for how computing skills relate to real world business processes.",
            "Professor/Teacher Name": "Rasleen Sidhu",
            "Professor/Teacher Email": "rasleen.sidhu@sait.ca"
          },
          {
            "Course ID": "MECH 205",
            "Course Name": "Electro-Mechanical Systems",
            "Course Average Weighted Grade": "",
            "Credit Hours": "3",
            "Course Description": "Electro-mechanical Systems is an introductory course to the world of automation for manufacturing. The course includes theory and lab activities involving pneumatic, electrical, electro-pneumatic, robotics, and computer control applications. The course design is for the beginner who is new to the various control systems and will benefit all Mechanical Engineering Technologists in the workplace as many companies adopt automation for sustainable growth of evolving and competitive manufacturing industries. Cross-referenced to the National Technology Benchmarks (NTB).",
            "Professor/Teacher Name": "Richard Arndt",
            "Professor/Teacher Email": "richard.arndt@sait.ca"
          },
          {
            "Course ID": "STCS 255",
            "Course Name": "Engineering Statics",
            "Course Average Weighted Grade": "",
            "Credit Hours": "1.5",
            "Course Description": "This course covers components and resultants of vectors, two-force members, free-body diagrams, equations of equilibrium, equilibrium of concurrent force systems and pulley systems, moments and couples, equilibrium of non concurrent force systems, truss analysis using method of joints and method of sections, and frame analysis using method of members.",
            "Professor/Teacher Name": "Borzumehr Toloui",
            "Professor/Teacher Email": "borzumehr.toloui@sait.ca"
          },
          {
            "Course ID": "THRM 200",
            "Course Name": "Introduction to Thermodynamics",
            "Course Average Weighted Grade": "",
            "Credit Hours": "1.5",
            "Course Description": "The study of energy in its many forms involves thermodynamic principles. Basic concepts of work, heat, flow and non-flow systems, and equations of state, perfect gases and properties of pure substances. The first law of thermodynamics is applied to practical systems like compressors, turbines, nozzles and other practical system to implement the concept of energy conversion. Basic power cycles will be analyzed and the performance merit to be determined. The various modes of heat transfer will be practiced and applied to simple situations. Cross-referenced to the National Technology Benchmarks (NTB).",
            "Professor/Teacher Name": "Christopher Taggart",
            "Professor/Teacher Email": "christopher.taggart@sait.ca"
          },
          {
            "Course ID": "MATH 238",
            "Course Name": "Mathematics for Engineering & Technology I",
            "Course Average Weighted Grade": "",
            "Credit Hours": "3",
            "Course Description": "This course enables the student to apply the basic knowledge of algebra and introductory calculus to resolve applied scientific and technological problems. Applications include linear motion, areas under curves, and volumes of revolution.",
            "Professor/Teacher Name": "Oluwafemi Alli",
            "Professor/Teacher Email": "femi.alli@sait.ca"
          },
          {
            "Course ID": "MECH 200",
            "Course Name": "Mechanical Engineering Technology Concepts",
            "Course Average Weighted Grade": "",
            "Credit Hours": "3",
            "Course Description": "This design course introduces the basic building blocks required for the common core and the three specializations. Using wide-ranging, flexible design reasoning the learner will learn how to set up problems based on a good understanding of the underlying principles, choose a plan to solve them, and present the results. Cross-referenced to the National Technology Benchmarks (NTB).",
            "Professor/Teacher Name": "Shaw Kinjo",
            "Professor/Teacher Email": "shaw.kinjo@sait.ca"
          }
        ];

        const deliverablesData = [
          {
            "Course ID": "MECH 205",
            "Category": "Quiz",
            "Deliverable": "Quiz 2a: Electronic Principles",
            "Open Date": "Sep 5, 2025 10:10 AM",
            "Close Date": "Sep 21, 2025 11:59 PM",
            "Weight %": "1.67",
            "Grade %": "97.14",
            "Letter Grade": "A+"
          },
          {
            "Course ID": "MECH 205",
            "Category": "Quiz",
            "Deliverable": "Quiz 2b: Series & Parallel Circuits",
            "Open Date": "Sep 7, 2025 11:59 PM",
            "Close Date": "Sep 28, 2025 11:59 PM",
            "Weight %": "1.67",
            "Grade %": "96.67",
            "Letter Grade": "A+"
          },
          {
            "Course ID": "MECH 205",
            "Category": "Lab",
            "Deliverable": "Lab 1: Basic Circuits & Ohm's Law",
            "Open Date": "Aug 28, 2025 11:59 PM",
            "Close Date": "Sep 28, 2025 11:59 PM",
            "Weight %": "3",
            "Grade %": "89.78",
            "Letter Grade": "A+"
          },
          {
            "Course ID": "THRM 200",
            "Category": "Assignment",
            "Deliverable": "Assignment 1",
            "Open Date": "Sep 1, 2025 12:00 AM",
            "Close Date": "Sep 28, 2025 11:59 PM",
            "Weight %": "3.34",
            "Grade %": "100",
            "Letter Grade": "A+"
          },
          {
            "Course ID": "THRM 200",
            "Category": "Quiz",
            "Deliverable": "Quiz 1",
            "Open Date": "Sep 8, 2025 12:00 AM",
            "Close Date": "Sep 28, 2025 11:59 PM",
            "Weight %": "3.34",
            "Grade %": "100",
            "Letter Grade": "A+"
          },
          {
            "Course ID": "COMP 213",
            "Category": "Assignment",
            "Deliverable": "Computer Skills Assignment",
            "Open Date": "Sep 4, 2025 12:01 AM",
            "Close Date": "Sep 16, 2025 11:59 PM",
            "Weight %": "13",
            "Grade %": "100",
            "Letter Grade": "A+"
          },
          {
            "Course ID": "COMP 213",
            "Category": "Exam",
            "Deliverable": "Computer Skills Exam",
            "Open Date": "Sep 18, 2025 12:15 PM",
            "Close Date": "Sep 18, 2025 1:00 PM",
            "Weight %": "6",
            "Grade %": "96",
            "Letter Grade": "A+"
          },
          {
            "Course ID": "MATH 238",
            "Category": "Quiz",
            "Deliverable": "Quiz 1",
            "Open Date": "Sep 14, 2025 4:37 PM",
            "Close Date": "Sep 14, 2025 4:52 PM",
            "Weight %": "2",
            "Grade %": "96.55",
            "Letter Grade": "A+"
          }
        ];

        // Load and display courses data - now works with both Live Server and direct file opening
        function loadCourses() {
            try {
                displayCourses(coursesData, deliverablesData);
            } catch (error) {
                console.error('Error loading courses:', error);
                document.getElementById('courses-container').innerHTML = 
                    '<div class="empty-state">Error loading courses data. Please check that the data is properly embedded.</div>';
            }
        }

        function displayCourses(courses, deliverables) {
            const container = document.getElementById('courses-container');
            
            if (!courses || courses.length === 0 || (courses.length === 1 && Object.values(courses[0]).every(val => val === ""))) {
                container.innerHTML = '<div class="empty-state">No courses data available. Add course information to Courses.json to display here.</div>';
                return;
            }

            container.innerHTML = courses.map(course => {
                const courseId = course['Course ID'] || 'Not specified';
                const courseName = course['Course Name'] || 'Not specified';
                const credits = course['Credit Hours'] || 'Not specified';
                const fullDescription = course['Course Description'] || 'No description available';
                const description = fullDescription.length > 100 ? fullDescription.substring(0, 100) + '...' : fullDescription;
                const professorName = course['Professor/Teacher Name'] || 'Not specified';
                const professorEmail = course['Professor/Teacher Email'] || '';
                
                // Calculate weighted average and completion for this course
                const courseDeliverables = deliverables.filter(deliverable => 
                    deliverable['Course ID'] === courseId
                );
                const averageGrade = calculateWeightedAverage(courseDeliverables);
                
                // Calculate completion percentage based on weight
                const totalWeight = courseDeliverables.reduce((sum, deliverable) => {
                    const weight = parseFloat(deliverable['Weight %']) || 0;
                    return sum + weight;
                }, 0);
                
                const completedWeight = courseDeliverables.reduce((sum, deliverable) => {
                    const weight = parseFloat(deliverable['Weight %']) || 0;
                    const isGraded = deliverable['Grade %'] && deliverable['Grade %'] !== '' && 
                                    deliverable['Grade %'] !== 'Not specified' && deliverable['Grade %'] !== 'Not graded';
                    const isSubmitted = deliverable['Status'] === 'submitted';
                    
                    if (isGraded || isSubmitted) {
                        return sum + weight;
                    }
                    return sum;
                }, 0);
                
                const completionPercentage = totalWeight > 0 ? 
                    ((completedWeight / totalWeight) * 100).toFixed(1) : 0;

                // Determine card class based on completion status
                let cardClass = 'course-card';
                const completionValue = parseFloat(completionPercentage);
                if (completionValue >= 100) {
                    cardClass += ' completed';
                } else if (completionValue >= 50) {
                    cardClass += ' in-progress';
                } else {
                    cardClass += ' not-started';
                }

                return `
                    <div class="${cardClass}" onclick="window.location.href='course-detail.html?id=${encodeURIComponent(courseId)}'">
                        <div class="course-header">
                            <div class="course-id">${courseId}</div>
                            <div class="course-credits">${credits} Credits</div>
                        </div>
                        
                        <div class="course-title">${courseName}</div>
                        <div class="course-description">${description}</div>
                        
                        <div class="course-details">
                            <div class="course-detail">
                                <div class="course-detail-label">Average Grade</div>
                                <div class="course-detail-value">${averageGrade}</div>
                            </div>
                            <div class="course-detail">
                                <div class="course-detail-label">Completion %</div>
                                <div class="course-detail-value">${completionPercentage}%</div>
                            </div>
                        </div>
                        
                        <div class="course-professor">
                            <div class="professor-name">${professorName}</div>
                            ${professorEmail && professorEmail !== 'Not specified' ? 
                                `<a href="mailto:${professorEmail}" class="professor-email" onclick="event.stopPropagation();">${professorEmail}</a>` : 
                                '<div class="professor-email">No email provided</div>'
                            }
                        </div>
                    </div>
                `;
            }).join('');
        }

        function calculateWeightedAverage(deliverables) {
            let totalWeightedPoints = 0;
            let totalWeight = 0;
            let gradedCount = 0;
            
            deliverables.forEach(deliverable => {
                const weight = parseFloat(deliverable['Weight %']) || 0;
                const grade = parseFloat(deliverable['Grade %']);
                
                if (!isNaN(grade) && grade > 0) {
                    totalWeightedPoints += (grade * weight);
                    totalWeight += weight;
                    gradedCount++;
                }
            });
            
            if (totalWeight === 0) {
                return 'No grades available';
            }
            
            const average = totalWeightedPoints / totalWeight;
            return `${average.toFixed(1)}%`;
        }

        // Load courses when page loads
        document.addEventListener('DOMContentLoaded', loadCourses);
    </script>
</body>
</html>
